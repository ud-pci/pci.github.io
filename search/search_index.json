{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to pCI's documentation pCI is a high-precision relativistic atomic calculation package based on the configuration interaction (CI) method and methods combining CI with many-body perturbation theory and/or the all-order coupled-cluster method. The serial version of the CI+MBPT code package was modified for public use and published in Computer Physics Communications in 2015 by M. Kozlov et al.","title":"Home"},{"location":"#welcome-to-pcis-documentation","text":"pCI is a high-precision relativistic atomic calculation package based on the configuration interaction (CI) method and methods combining CI with many-body perturbation theory and/or the all-order coupled-cluster method. The serial version of the CI+MBPT code package was modified for public use and published in Computer Physics Communications in 2015 by M. Kozlov et al.","title":"Welcome to pCI's documentation"},{"location":"about/","text":"About Us pCI Development Team Marianna Safronova Charles Cheung Sergey Porsev Mikhail Kozlov Ilya Tupitsyn Andrey Bondarev","title":"About"},{"location":"about/#about-us","text":"","title":"About Us"},{"location":"about/#pci-development-team","text":"Marianna Safronova Charles Cheung Sergey Porsev Mikhail Kozlov Ilya Tupitsyn Andrey Bondarev","title":"pCI Development Team"},{"location":"changelog/","text":"Changelog v0.0.2 March 20, 2021 dtm now uses determinants module for determinant-based subroutines made arrays storing configurations (iconf1, iconf2) consistent between all programs several minor text edits descriptions added for several subroutines in davidson module v0.0.1 March 17, 2021 Fixed issue with table of J being unordered. v0.0.0 March 17, 2021 Initial upload of conf, conf_pt, and dtm codes to github.","title":"Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#v002","text":"March 20, 2021 dtm now uses determinants module for determinant-based subroutines made arrays storing configurations (iconf1, iconf2) consistent between all programs several minor text edits descriptions added for several subroutines in davidson module","title":"v0.0.2"},{"location":"changelog/#v001","text":"March 17, 2021 Fixed issue with table of J being unordered.","title":"v0.0.1"},{"location":"changelog/#v000","text":"March 17, 2021 Initial upload of conf, conf_pt, and dtm codes to github.","title":"v0.0.0"},{"location":"installation/","text":"Installation Required libraries In order to compile pCI the following software libraries and tools are required: Intel Fortran compiler. CMake build tool. (Optional) MPI library to run on high-performance computing clusters. The codes have only been tested with OpenMPI so far. Obtaining the source code Users can download the latest version of the pCI code package from https://github.com/ccheung93/pCI via git From the command line, you can clone the latest version: git clone https://github.com/ccheung93/pCI.git Building with CMake The codes are built using the 'CMakeLists.txt' file. The following are some example builds on the DARWIN computing cluster. A Debug build can be done: $ cd pCI $ mkdir build-debug $ cd build-debug $ vpkg_require cmake openmpi/4.1.0:intel-2020 $ FC=mpifort cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=$(pwd)/../20200402-debug .. : $ make $ make install An optimized build demands a little more: $ cd .. $ mkdir build-opt $ cd build-opt $ FC=mpifort cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=$(pwd)/../20200317-opt -DCMAKE_Fortran_FLAGS_RELEASE=\"-g -O3 -mcmodel=large -xHost -m64\" .. : $ make $ make install","title":"Installation"},{"location":"installation/#installation","text":"","title":"Installation"},{"location":"installation/#required-libraries","text":"In order to compile pCI the following software libraries and tools are required: Intel Fortran compiler. CMake build tool. (Optional) MPI library to run on high-performance computing clusters. The codes have only been tested with OpenMPI so far.","title":"Required libraries"},{"location":"installation/#obtaining-the-source-code","text":"Users can download the latest version of the pCI code package from https://github.com/ccheung93/pCI","title":"Obtaining the source code"},{"location":"installation/#via-git","text":"From the command line, you can clone the latest version: git clone https://github.com/ccheung93/pCI.git","title":"via git"},{"location":"installation/#building-with-cmake","text":"The codes are built using the 'CMakeLists.txt' file. The following are some example builds on the DARWIN computing cluster. A Debug build can be done: $ cd pCI $ mkdir build-debug $ cd build-debug $ vpkg_require cmake openmpi/4.1.0:intel-2020 $ FC=mpifort cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=$(pwd)/../20200402-debug .. : $ make $ make install An optimized build demands a little more: $ cd .. $ mkdir build-opt $ cd build-opt $ FC=mpifort cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=$(pwd)/../20200317-opt -DCMAKE_Fortran_FLAGS_RELEASE=\"-g -O3 -mcmodel=large -xHost -m64\" .. : $ make $ make install","title":"Building with CMake"},{"location":"theory/","text":"Theory For any many-electron system, we can divide all electrons into core and valence electrons. In this way, we can separate the electron-electron correlation problem into one describing the valence-valence correlations under the frozen-core approximation, and another describing the core-core and core-valence correlations. In the initial approximation, we start from the solution of the restricted Dirac-Hartree-Fock (HFD) equations in the central field approximation to construct one-electron orbitals for the core and valence electrons. Virtual orbitals can be constructed from B-splines or by other means to account for correlations. The valence-valence correlation problem is solved using the CI method, while core-core and core-valence correlations are included using either MBPT or the all-order method. In either case, we form an effective Hamiltonian in the valence CI space, then diagonalize the effective Hamiltonian using the CI method to find energies and wave functions for the low-lying states. Configuration Interaction The CI method is a standard ab initio method for calculating atomic properties of many-electron systems. In the valence space, the CI wave function is constructed as a linear combination of all distinct states of a specified angular momentum J and parity \\Psi_J=\\sum_ic_i\\Phi_i, where the set \\left\\{\\Phi_i\\right\\} are Slater determinants generated by exciting electrons from some reference configurations obtained to higher orbitals. Varying the coefficients $c_i$ results in a generalized eigenvalue problem \\sum_j\\langle\\Phi_i|H|\\Phi_j\\rangle c_j = Ec_i, which can be written in matrix form and diagonalized to find the energies and wave functions of the low-lying states. The energy matrix of the CI method can be obtained as a projection of the exact Hamiltonian H onto the CI subspace H^\\text{CI} [^1] H^\\text{CI}=E_\\text{core}+\\sum_{i>N_\\text{core}}h_i^\\text{CI}+\\sum_{j>i>N_\\text{core}}V_{ij}, where E_\\text{core} is the energy of the frozen core, N_\\text{core} is the number of core electrons, h_i^\\text{CI} accounts for the kinetic energy of the valence electrons and their interaction with the central field, and V_{ij} accounts for the valence-valence correlations. Having obtained from CI the many-electron states |J M\\rangle and |J' M'\\rangle with the total angular momenta J,J' and their projections M,M' , one can form density transition matrix in terms of the one-electron states |nljm\\rangle [^2] \\hat{\\rho}=\\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}|nljm\\rangle\\langle n^\\prime l^\\prime j^\\prime m^\\prime|, where \\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}=\\langle J^\\prime M^\\prime|a_{n^\\prime l^\\prime j^\\prime m^\\prime}^\\dagger a_{nljm}|JM\\rangle. Here un-primed indices refer to the initial state and primed indices refer to the final state. The many-electron matrix element can then be written as \\langle J^\\prime M^\\prime|T_q^L|JM\\rangle=\\text{Tr}\\,\\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}\\langle n^\\prime l^\\prime j^\\prime m^\\prime|T_q^L|nljm\\rangle, where the trace sums over all quantum numbers (nljm) and (n^\\prime l^\\prime j^\\prime m^\\prime) , and T_q^L is the spherical component of the tensor operator of rank L . Using the Wigner-Eckart theorem, one can reduce the many-electron matrix element to \\langle J^\\prime \\Vert T^L \\Vert J\\rangle = \\text{Tr}\\,\\rho_{nlj,n^\\prime l^\\prime j^\\prime}^L \\langle n^\\prime l^\\prime j^\\prime\\Vert T^L \\Vert nlj\\rangle, where \\rho_{nlj,n^\\prime l^\\prime j^\\prime}^L = (-1)^{J^\\prime -M^\\prime}\\left( \\begin{array}{ccc} J^\\prime & L & J \\\\ -M^\\prime & q & M \\end{array}\\right)^{-1} \\sum_{mm^\\prime} (-1)^{j^\\prime-m^\\prime}\\left( \\begin{array}{ccc} j^\\prime & L & j \\\\ -m^\\prime & q & m \\end{array}\\right) \\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}. We have developed new parallel programs based on these methods: conf realizes the CI method, which forms the CI Hamiltonian and uses Davidson's algorithm of diagonalization [^3] to find low-lying energies and wave functions; dtm calculates reduced matrix elements of one-electron operators by forming the reduced density transition matrices. Valence Perturbation Theory As the number of configurations contributing to the CI wave function grows exponentially with the number of valence electrons, efficient selection of the most important configurations from a set of configurations becomes the main challenge of accurate computations. To significantly reduce the number of configurations, we further developed a method suggested in Ref. [^4] to predict important configurations based on a set of configurations with known weights. This method can be used to optimize the CI space by identifying the most important configurations from a list of CI configurations using perturbation theory (PT). All second-order corrections are taken into account and added to the energy calculated from CI to obtain the total energy, E^\\text{CI}=E_0+E_1 , while first-order corrections to the wave functions are stored for use in subsequent CI calculations. This process of using CI on a small subspace, calculating corrections via PT, and reordering the list of configurations in descending weights can be repeated several times to form the most optimal CI subspace. Once the energy differences between subsequent CI calculations are relatively small, it can be assumed that convergence has been met. We've developed a new parallel program conf_pt that realizes the CI+PT method. The parallel version enables computations of extremely large problems, with tests running up to 400 million determinants. References [^1]: V. A. Dzuba, V. V. Flambaum, and M. G. Kozlov. Combination of the many-body perturbation theory with the configuration-interaction method. Phys. Rev. A , 54 5 :3948\u20133959, November 1996. [^2]: M. G. Kozlov, S. G. Porsev, M. S. Safronova, and I. I. Tupitsyn. CI-MBPT: A package of programs for relativistic atomic calculations based on a method combining configuration interaction and many-body perturbation theory. Computer Physics Communications , 195:199\u2013213, 2015. [^3]: Ernest R. Davidson. The iterative calculation of a few of the lowest eigenvalues and corresponding eigenvectors of large real-symmetric matrices. Journal of Computational Physics , 17 1 :87\u201394, January 1975. [^4]: Yu. G. Rakhlina, M. G. Kozlov, and S. G. Porsev. The energy of electron affinity to a zirconium atom. Optics and Spectroscopy , 90 6 :817\u2013821, June 2001.","title":"Theory"},{"location":"theory/#theory","text":"For any many-electron system, we can divide all electrons into core and valence electrons. In this way, we can separate the electron-electron correlation problem into one describing the valence-valence correlations under the frozen-core approximation, and another describing the core-core and core-valence correlations. In the initial approximation, we start from the solution of the restricted Dirac-Hartree-Fock (HFD) equations in the central field approximation to construct one-electron orbitals for the core and valence electrons. Virtual orbitals can be constructed from B-splines or by other means to account for correlations. The valence-valence correlation problem is solved using the CI method, while core-core and core-valence correlations are included using either MBPT or the all-order method. In either case, we form an effective Hamiltonian in the valence CI space, then diagonalize the effective Hamiltonian using the CI method to find energies and wave functions for the low-lying states.","title":"Theory"},{"location":"theory/#configuration-interaction","text":"The CI method is a standard ab initio method for calculating atomic properties of many-electron systems. In the valence space, the CI wave function is constructed as a linear combination of all distinct states of a specified angular momentum J and parity \\Psi_J=\\sum_ic_i\\Phi_i, where the set \\left\\{\\Phi_i\\right\\} are Slater determinants generated by exciting electrons from some reference configurations obtained to higher orbitals. Varying the coefficients $c_i$ results in a generalized eigenvalue problem \\sum_j\\langle\\Phi_i|H|\\Phi_j\\rangle c_j = Ec_i, which can be written in matrix form and diagonalized to find the energies and wave functions of the low-lying states. The energy matrix of the CI method can be obtained as a projection of the exact Hamiltonian H onto the CI subspace H^\\text{CI} [^1] H^\\text{CI}=E_\\text{core}+\\sum_{i>N_\\text{core}}h_i^\\text{CI}+\\sum_{j>i>N_\\text{core}}V_{ij}, where E_\\text{core} is the energy of the frozen core, N_\\text{core} is the number of core electrons, h_i^\\text{CI} accounts for the kinetic energy of the valence electrons and their interaction with the central field, and V_{ij} accounts for the valence-valence correlations. Having obtained from CI the many-electron states |J M\\rangle and |J' M'\\rangle with the total angular momenta J,J' and their projections M,M' , one can form density transition matrix in terms of the one-electron states |nljm\\rangle [^2] \\hat{\\rho}=\\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}|nljm\\rangle\\langle n^\\prime l^\\prime j^\\prime m^\\prime|, where \\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}=\\langle J^\\prime M^\\prime|a_{n^\\prime l^\\prime j^\\prime m^\\prime}^\\dagger a_{nljm}|JM\\rangle. Here un-primed indices refer to the initial state and primed indices refer to the final state. The many-electron matrix element can then be written as \\langle J^\\prime M^\\prime|T_q^L|JM\\rangle=\\text{Tr}\\,\\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}\\langle n^\\prime l^\\prime j^\\prime m^\\prime|T_q^L|nljm\\rangle, where the trace sums over all quantum numbers (nljm) and (n^\\prime l^\\prime j^\\prime m^\\prime) , and T_q^L is the spherical component of the tensor operator of rank L . Using the Wigner-Eckart theorem, one can reduce the many-electron matrix element to \\langle J^\\prime \\Vert T^L \\Vert J\\rangle = \\text{Tr}\\,\\rho_{nlj,n^\\prime l^\\prime j^\\prime}^L \\langle n^\\prime l^\\prime j^\\prime\\Vert T^L \\Vert nlj\\rangle, where \\rho_{nlj,n^\\prime l^\\prime j^\\prime}^L = (-1)^{J^\\prime -M^\\prime}\\left( \\begin{array}{ccc} J^\\prime & L & J \\\\ -M^\\prime & q & M \\end{array}\\right)^{-1} \\sum_{mm^\\prime} (-1)^{j^\\prime-m^\\prime}\\left( \\begin{array}{ccc} j^\\prime & L & j \\\\ -m^\\prime & q & m \\end{array}\\right) \\rho_{nljm,n^\\prime l^\\prime j^\\prime m^\\prime}. We have developed new parallel programs based on these methods: conf realizes the CI method, which forms the CI Hamiltonian and uses Davidson's algorithm of diagonalization [^3] to find low-lying energies and wave functions; dtm calculates reduced matrix elements of one-electron operators by forming the reduced density transition matrices.","title":"Configuration Interaction"},{"location":"theory/#valence-perturbation-theory","text":"As the number of configurations contributing to the CI wave function grows exponentially with the number of valence electrons, efficient selection of the most important configurations from a set of configurations becomes the main challenge of accurate computations. To significantly reduce the number of configurations, we further developed a method suggested in Ref. [^4] to predict important configurations based on a set of configurations with known weights. This method can be used to optimize the CI space by identifying the most important configurations from a list of CI configurations using perturbation theory (PT). All second-order corrections are taken into account and added to the energy calculated from CI to obtain the total energy, E^\\text{CI}=E_0+E_1 , while first-order corrections to the wave functions are stored for use in subsequent CI calculations. This process of using CI on a small subspace, calculating corrections via PT, and reordering the list of configurations in descending weights can be repeated several times to form the most optimal CI subspace. Once the energy differences between subsequent CI calculations are relatively small, it can be assumed that convergence has been met. We've developed a new parallel program conf_pt that realizes the CI+PT method. The parallel version enables computations of extremely large problems, with tests running up to 400 million determinants.","title":"Valence Perturbation Theory"},{"location":"theory/#references","text":"[^1]: V. A. Dzuba, V. V. Flambaum, and M. G. Kozlov. Combination of the many-body perturbation theory with the configuration-interaction method. Phys. Rev. A , 54 5 :3948\u20133959, November 1996. [^2]: M. G. Kozlov, S. G. Porsev, M. S. Safronova, and I. I. Tupitsyn. CI-MBPT: A package of programs for relativistic atomic calculations based on a method combining configuration interaction and many-body perturbation theory. Computer Physics Communications , 195:199\u2013213, 2015. [^3]: Ernest R. Davidson. The iterative calculation of a few of the lowest eigenvalues and corresponding eigenvectors of large real-symmetric matrices. Journal of Computational Physics , 17 1 :87\u201394, January 1975. [^4]: Yu. G. Rakhlina, M. G. Kozlov, and S. G. Porsev. The energy of electron affinity to a zirconium atom. Optics and Spectroscopy , 90 6 :817\u2013821, June 2001.","title":"References"}]}